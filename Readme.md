Full spike vq-vae implementation

Plan to submit to NIPS2023
