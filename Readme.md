Full spike vq-vae implementation
